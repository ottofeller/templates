import {javascript, TextFile, web} from 'projen'
import {SampleCode, srcCode} from './SampleCode'

/**
 * Project that wraps NextJsTypeScriptProject and adds specific configurations and sample code.
 *
 * @pjid ottofeller-nextjs
 */
export class OttofellerNextJs extends web.NextJsTypeScriptProject {
  constructor(options: web.NextJsTypeScriptProjectOptions) {
    super({
      ...options,
      sampleCode: false,
      packageManager: javascript.NodePackageManager.NPM,
    })

    new TextFile(this, '.npmrc', {
      lines: [
        '# ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".',
        'fund=false',
        'loglevel=error',
        'engine-strict=true',
        'send-metrics=false',
        'legacy-peer-deps=true',
      ],
    })

    this.addDeps(
      '@apollo/client',
      '@tailwindcss/line-clamp',
      'classnames',
      'cookie-parser',
      'dayjs',
      'dotenv',
      'graphql-request',
      'jsonwebtoken',
      'next-cookies',
      'next-env',
      'next-with-apollo',
      'react-hook-form',
      'react-portal',
      'yup',
    )

    this.addDevDeps(
      '@graphql-codegen/add',
      '@graphql-codegen/cli',
      '@graphql-codegen/import-types-preset',
      '@graphql-codegen/introspection',
      '@graphql-codegen/named-operations-object',
      '@graphql-codegen/typescript',
      '@graphql-codegen/typescript-graphql-request',
      '@graphql-codegen/typescript-operations',
      '@graphql-codegen/typescript-react-apollo',
      '@ottofeller/dangerules',
      '@ottofeller/eslint-config-ofmt',
      '@ottofeller/ofmt',
      '@ottofeller/prettier-config-ofmt',
      '@testing-library/react',
      '@types/jest',
      'ajv',
      'danger',
      'empty',
      'eslint',
      'eslint-plugin-graphql',
      'graphql',
      'jest',
      'jest-environment-jsdom',
      'jest-fetch-mock',
      'jest-transform-stub',
      'npm-run-all',
      'postcss',
      'react-test-renderer',
      'stylelint',
      'stylelint-declaration-block-no-ignored-properties',
      'stylelint-images',
      'stylelint-order',
    )

    new SampleCode(this, 'index.tsx', srcCode)
  }
}
